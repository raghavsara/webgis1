(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[8443],{546997:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>w});var s=o(893379),n=o.n(s),r=o(560691);n()(r.Z,{insert:"head",singleton:!1}),r.Z.locals;var a=o(124852),l=o.n(a),A=o(171703),i=o(630294);const c="CHANGE_LOCATE_STATE",p="LOCATE_ERROR";function u(t){return{type:c,state:t}}var h=o(488400),d=o(45697),g=o.n(d),E=o(804504),m=o(401811),f=o(68390),C=o.n(f),I=o(23888);function y(){return y=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},y.apply(this,arguments)}function L(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}o.e(5593).then(o.bind(o,645593));let k=!1,b=!1;class v extends l().Component{constructor(){super(...arguments),L(this,"onClick",(()=>{let t;switch(this.props.locate){case"FOLLOWING":case"LOCATING":case"PERMISSION_DENIED":t="DISABLED";break;case"ENABLED":t="FOLLOWING";break;case"DISABLED":t="ENABLED"}this.props.onClick(t)})),L(this,"renderButton",(()=>{const t="PERMISSION_DENIED"===this.props.locate;return l().createElement(I.Z,y({id:this.props.id,disabled:t},this.props.btnConfig,{onClick:this.onClick,bsStyle:this.getBtnStyle(),style:this.props.style}),l().createElement(i.Glyphicon,{glyph:this.props.glyph}),this.props.text,this.props.help)})),L(this,"renderLoadingButton",(()=>{let t=l().createElement("img",{src:C(),style:{display:"inline-block",margin:"0px",padding:0,background:"transparent",border:0},alt:"..."});return l().createElement(I.Z,y({id:this.props.id,onClick:this.onClick},this.props.btnConfig,{bsStyle:this.getBtnStyle(),style:this.props.style}),t)})),L(this,"addTooltip",(t=>{const e=l().createElement(i.Tooltip,{id:"locate-tooltip"},l().createElement(E.Z,{msgId:this.props.tooltip}));return l().createElement(m.Z,{placement:this.props.tooltipPlace,key:`{overlay-trigger.${this.props.id}-${this.props.tooltip}}`,overlay:e},t)})),L(this,"getBtnStyle",(()=>{const{locate:t,bsStyle:e}=this.props;let o=e;return"FOLLOWING"!==t&&"ENABLED"!==t||(o="success active"),o}))}UNSAFE_componentWillMount(){var t,e;"PERMISSION_DENIED"===this.props.locate||k||b||(k=!0,null!==(t=navigator)&&void 0!==t&&null!==(e=t.geolocation)&&void 0!==e&&e.getCurrentPosition?navigator.geolocation.getCurrentPosition((()=>{k=!1,b=!0}),(t=>{k=!1,1===t.code&&this.props.onClick("PERMISSION_DENIED")})):(k=!1,this.props.onClick("PERMISSION_DENIED")))}render(){var t="LOCATING"===this.props.locate?this.renderLoadingButton():this.renderButton();return this.props.tooltip?this.addTooltip(t):t}}L(v,"propTypes",{id:g().string,hide:g().bool,btnConfig:g().object,text:g().oneOfType([g().string,g().element]),help:g().oneOfType([g().string,g().element]),locate:g().string,onClick:g().func,tooltip:g().element,tooltipPlace:g().string,style:g().object,bsStyle:g().string,glyph:g().string}),L(v,"defaultProps",{id:"locate-btn",onClick:()=>{},locate:"DISABLED",tooltipPlace:"left",bsStyle:"default",glyph:"1-position-1",btnConfig:{className:"square-button"}});const D=v;var O=o(152543),S=o(727418),N=o.n(S);var B=o(588887);const T=(0,A.connect)((t=>({locate:t.locate&&t.locate.state||"DISABLED",tooltip:t.locate&&"FOLLOWING"===t.locate.state?"locate.tooltipDeactivate":"locate.tooltip"})),{onClick:u})(D),w=(0,O.rx)("Locate",{component:T,options:{disablePluginIf:"{state('mapType') === 'cesium'}"},containers:{Toolbar:{name:"locate",position:2,tool:!0,icon:l().createElement(i.Glyphicon,{glyph:"screenshot"}),help:l().createElement(h.Z,{msgId:"helptexts.locateBtn"}),priority:1},Map:{name:"Locate",Tool:(0,A.connect)((t=>({status:t.locate&&t.locate.state,messages:t.locale&&t.locale.messages?t.locale.messages.locate:void 0})),{changeLocateState:u,onLocateError:function(t){return{type:p,error:t}}})((t=>{let{map:e,mapType:o,speedThreshold:s,status:n,messages:r,maxZoom:l,changeLocateState:A,onLocateError:i,rateControl:c}=t;const p=(0,a.useRef)(),[u,h,d]=(0,B.default)(o,"locate");(0,a.useEffect)((()=>{d&&i(d)}),[d]);const g=t=>{n!==t&&A(t)},E=t=>{i(t.message),A("DISABLED")};function m(){return{locateOptions:{...void 0!==l&&{maxZoom:l},...void 0!==c&&{rateControl:c},...void 0!==s&&{speedThreshold:s}}}}return(0,a.useEffect)((()=>{if(u){const t=m();p.current=new h,p.current.start({map:e,options:t,messages:r,status:n,onStateChange:g,onLocationError:E})}return()=>{var t;null===(t=p.current)||void 0===t||t.clear()}}),[u]),(0,a.useEffect)((()=>{var t;const e=m();null===(t=p.current)||void 0===t||t.update({status:n,messages:r,options:e})}),[n,r,u,l]),null})),priority:1}},reducers:{locate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{state:"DISABLED"},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case c:return N()({},t,{state:e.state});case p:return N()({},t,{error:e.error});default:return t}}}})},560691:(t,e,o)=>{"use strict";o.d(e,{Z:()=>r});var s=o(923645),n=o.n(s)()((function(t){return t[1]}));n.push([t.id,".ms2 #locate-btn {\n    position: absolute;\n    z-index: 1000;\n    right: 10px;\n    bottom: 150px;\n}\n\n.ms2 #mapstore-toolbar #locate-btn {\n    position: static;\n}\n",""]);const r=n},68390:t=>{t.exports="data:image/gif;base64,R0lGODlhEAALAPQAAP///zMzM+Hh4dnZ2e7u7jc3NzMzM1dXV5qamn9/f8fHx05OTm5ubqGhoYKCgsrKylFRUTY2NnFxcerq6t/f3/b29l9fX+Li4vT09MTExLKystTU1PHx8QAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCwAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7AAAAAAAAAAAA"},588887:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>n});var s=o(124852);const n=(t,e)=>{const[n,r]=(0,s.useState)(!1),[a,l]=(0,s.useState)(null),A=(0,s.useRef)(),i=(0,s.useRef)();return(0,s.useEffect)((()=>(i.current=!0,()=>{i.current=!1})),[]),(0,s.useEffect)((()=>(t&&!A.current&&(r(!1),l(null),o(78641)("./"+t+"/"+e).then((t=>{i.current&&(A.current=t.default,r(!0))})).catch((t=>{i.current&&l(t)}))),()=>{})),[t]),[n,A.current,a]}},78641:(t,e,o)=>{var s={"./hooks/useMapTool":[588887],"./hooks/useMapTool.js":[588887],"./leaflet/locate":[401419,5243,1419],"./leaflet/locate.js":[401419,5243,1419],"./openlayers/locate":[554712,778,1324,302,4712],"./openlayers/locate.js":[554712,778,1324,302,4712]};function n(t){if(!o.o(s,t))return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=s[t],n=e[0];return Promise.all(e.slice(1).map(o.e)).then((()=>o(n)))}n.keys=()=>Object.keys(s),n.id=78641,t.exports=n}}]);