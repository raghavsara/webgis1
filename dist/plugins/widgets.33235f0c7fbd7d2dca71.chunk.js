(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[5795],{495020:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>x});var i=o(124852),s=o.n(i),n=o(45697),l=o.n(n),r=o(171703),d=o(22222),a=o(867076),g=o(152543),c=o(274363),u=o(952273),p=o(492838),h=o(725211),w=o(748928),f=o(906351),W=o(424707),m=o(350126);function v(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const b=(0,a.compose)((0,r.connect)((0,d.P1)(c.J9,u.E5,u.p,u.Jb,u.h9,(e=>(0,m.ic)(e,{right:!0})),(e=>e.browser&&e.browser.mobile),u.zm,((e,t,o,i,s,n,l,r)=>({id:e,widgets:t,layouts:o,maximized:i,dependencies:s,mapLayout:n,isMobileAgent:l,dropdownWidgets:r}))),{editWidget:p.uT,updateWidgetProperty:p.Ij,exportCSV:p.sD,toggleCollapse:p.f,toggleCollapseAll:p.Ff,toggleMaximize:p.Pt,exportImage:p.Rb,deleteWidget:p.E9,onLayoutChange:p.c_}),(0,a.compose)((0,f.Gv)({debounceTime:20,closest:!0,querySelector:".fill"}),(0,f.ZY)({overrideWidthProvider:!1}),(0,a.withProps)((e=>{let{isMobileAgent:t,width:o,mapLayout:i,singleWidgetLayoutBreakpoint:s=1024}=e;const n=(null==i?void 0:i.right)??0,l=t||o<=s,r=l?0:500;return{backgroundSelectorOffset:l?t?40:60:0,isSingleWidgetLayout:l,viewWidth:o-(n+55+r),rightOffset:n,leftOffset:r,singleWidgetLayoutBreakpoint:s}})),(0,a.withProps)((function(){let{width:e,height:t,maximized:o,leftOffset:i,viewWidth:s,isSingleWidgetLayout:n,singleWidgetLayoutMaxHeight:l=300,singleWidgetLayoutMinHeight:r=200,backgroundSelectorOffset:d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=n?(t-d-120)/2:t-d-120,g=n?1:4,c=n?a>l?l:a<r?r:l:Math.floor(a/g-20),u=null!=o&&o.widget?{width:"100%",height:"100%",marginTop:0,bottom:"auto",top:0,left:0,zIndex:1330}:{},p=null!=o&&o.widget?{width:e,useDefaultWidthProvider:!1,rowHeight:t-50,breakpoints:{xxs:0},cols:{xxs:1}}:{},h=e?{width:s-1}:{},w=n?c:Math.floor((t-100)/(c+10))*(c+10);return{rowHeight:c,className:"on-map",breakpoints:n?{xxs:0}:{md:0},cols:{md:6,xxs:1},...h,useDefaultWidthProvider:!1,style:{left:i+"px",bottom:65+d,height:w,width:s+"px",position:"absolute",zIndex:50,...u},...p}}))),(0,a.compose)((0,a.defaultProps)({toolsOptions:{showPin:"user.role===ADMIN",seeHidden:"user.role===ADMIN",showHide:!1,showCollapse:!0,showMaximize:!0}}),(0,h.Z)("toolsOptions",{asObject:!0}),(0,a.compose)((0,r.connect)((0,d.P1)(u.Xu,(e=>({tray:e})))),(0,a.withPropsOnChange)(["toolsOptions","tray"],(e=>{let{toolsOptions:t,tray:o}=e;return{toolsOptions:t?{...t,showCollapse:t.showCollapse&&o}:t}}))),(0,a.withPropsOnChange)(["widgets","toolsOptions"],(e=>{let{widgets:t=[],toolsOptions:o={}}=e;return{widgets:t.filter((e=>{let{hide:t}=e;return!t||o.seeHidden}))}})),(0,a.compose)((0,a.withState)("activeWidget","setActiveWidget",!1),(0,a.withHandlers)({toggleCollapse:e=>t=>{var o;const i=null===(o=e.widgets)||void 0===o?void 0:o.find((t=>{var o;return t.id===(null===(o=e.activeWidget)||void 0===o?void 0:o.id)}));e.isSingleWidgetLayout&&i?e.toggleCollapseAll():e.toggleCollapse(t)}}),(0,a.withPropsOnChange)(["dropdownWidgets","toolsOptions"],(e=>{let{dropdownWidgets:t=[],toolsOptions:o={}}=e;return{dropdownWidgets:t.filter((e=>{let{hide:t}=e;return!t||o.seeHidden}))}})),(0,a.withPropsOnChange)(["widgets","isSingleWidgetLayout","id"],(e=>{let{widgets:t,isSingleWidgetLayout:o,activeWidget:i,setActiveWidget:s}=e;t.length&&o&&!i&&s(t[0])})),(0,a.withPropsOnChange)(["activeWidget","isSingleWidgetLayout","widgets"],(e=>{let{activeWidget:t,dropdownWidgets:o,isSingleWidgetLayout:i,widgets:s,toolsOptions:n,layouts:l,setActiveWidget:r}=e;if(t&&i&&s.length){const e={...t,options:{activeWidget:t,dropdownWidgets:o,...t.options??{},singleWidget:!0,setActiveWidget:r}};return{canEdit:!1,toolsOptions:{...n,showPin:!1},layouts:{...l,xxs:[...l.xxs.map((e=>({...e,h:1,w:1,x:0,y:0})))]},widgets:[e]}}return!1})))))(W.Z);class P extends s().Component{render(){return this.props.enabled?s().createElement(b,this.props):null}}v(P,"propTypes",{enabled:l().bool}),v(P,"defaultProps",{enabled:!0});const O=(0,w.Z)(P),x=(0,g.rx)("WidgetsPlugin",{component:O,containers:{TOC:{doNotHide:!0,name:"Widgets"}},reducers:{widgets:o(890827).Z},epics:o(660834).ZP})},748928:(e,t,o)=>{"use strict";o.d(t,{Z:()=>r});var i=o(22222),s=o(171703),n=o(350126),l=o(101092);const r=(0,s.connect)((0,i.P1)(n.Jz,n.VM,l.c0,((e,t,o)=>({enabled:!e&&!t&&!o}))))},725211:(e,t,o)=>{"use strict";o.d(t,{Z:()=>b});var i=o(867076),s=o(171703),n=o(22222),l=o(274363),r=o(510644),d=o(227361),a=o.n(d),g=o(984596),c=o.n(g),u=o(66604),p=o.n(u),h=o(747037),w=o.n(h),f=o(701469),W=o.n(f);const m=e=>{let{accessInfo:t,postProcessValue:o,reduceFun:i}=e;return e=>{let s=c()(e),n=i;return s.length>1&&"__OR__"===s[0]&&(n=(e,t)=>e||t,s=s.slice(1)),s.map((e=>{let s=e;if(W()(s))return m({accessInfo:t,postProcessValue:o,reduceFun:i})(s);let n=!1;s&&w()(s)&&s.startsWith("!")&&(n=!0,s=s.substr(1));const l=e=>n?!e:e,r=w()(s)&&s.split(":");if(r&&r[0]){const e=r[0].split(/\!\=\=?/),i=r[0].split(/\=\=?\=?/);return e.length>1?l(o(a()(t,e[0]),s)!==e[1]):i.length>1?l(o(a()(t,i[0]),s)===i[1]):l(o(a()(t,r[0]),s))}return s})).reduce(n||((e,t)=>e&&t))}},v=function(e){let{asObject:t=!1,postProcessValue:o=(e=>e),reduceFun:s,accessInfo:n="accessInfo"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.withPropsOnChange)([e,n],(function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?{[e]:p()(i[e],m({accessInfo:i[n],postProcessValue:o,reduceFun:s}))}:{[e]:m({accessInfo:i[n],postProcessValue:o,reduceFun:s})(i[e])}}))},b=function(){return(0,i.compose)((0,s.connect)((0,n.P1)(l.J9,l._H,r.np,((e,t,o)=>({accessInfo:{mapId:e,mapInfo:t,user:o}})))),v(...arguments))}}}]);