(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[8117],{692741:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n={GrabMap:null,Preview:null}},239177:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n={GrabMap:s(726413).Z,Preview:s(630992).Z}},726413:(e,t,s)=>{"use strict";s.d(t,{Z:()=>E});var n=s(45697),a=s.n(n),o=s(124852),r=s.n(o),i=s(234228),p=s(331655),l=s(618446),h=s.n(l),c=s(461120),d=s.n(c),u=s(459425),m=s.n(u),g=s(882702),y=s(893379),v=s.n(y),f=s(555198);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}v()(f.Z,{insert:"head",singleton:!1}),f.Z.locals;class S extends r().Component{constructor(){super(...arguments),b(this,"getCanvas",(()=>this.refs.canvas)),b(this,"mapChanged",(e=>!h()(e.layers,this.props.layers)||e.active!==this.props.active||e.config!==this.props.config)),b(this,"mapIsLoading",(e=>e.some((e=>e.visibility&&e.loading)))),b(this,"triggerShooting",(e=>{this.previousTimeout&&clearTimeout(this.previousTimeout),this.previousTimeout=setTimeout((()=>{this.doSnapshot(this.props)}),e)})),b(this,"doSnapshot",(e=>{var t=window.getComputedStyle(this.mapDiv).getPropertyValue("left");t="auto"===t?0:t;let s,n,a,o,r,i=this.mapDiv.getElementsByClassName("leaflet-map-pane"),p=i&&i[0],l=p&&p.getElementsByClassName("leaflet-objects-pane"),h=l&&l[0],c=h&&h.getElementsByTagName("svg"),u=c&&c[0]&&c[0].cloneNode(!0);if(u){let e=u.style&&u.style.transform?u.style.transform.replace(/\(|\)|translate3d|translate/g,"").split("px, "):["0","0"];e=[Number.parseFloat(e[0].replace("px","")),Number.parseFloat(e[1].replace("px",""))],e=u.style.transform&&"translate3d"===u.style.transform.substr(0,11)?[0,0]:e,s=c[0]?c[0].getBoundingClientRect().left-e[0]:0,n=c[0]?c[0].getBoundingClientRect().top-e[1]:0,r=c[0].outerHTML?c[0].outerHTML:this.outerHTML(c[0]),o=u.getAttribute("width"),a=u.getAttribute("height"),u.setAttribute("style","")}let y=0;t&&(y=parseInt(t.replace("px",""),10));let v=this.mapDiv.getElementsByClassName("leaflet-map-pane"),f=v&&v[0]&&v[0].style&&v[0].style.transform?v[0].style.transform.replace(/\(|\)|translate3d|translate/g,"").split("px, "):["0","0"];f=[Number.parseFloat(f[0].replace("px","")),Number.parseFloat(f[1].replace("px",""))];let b=this.mapDiv.getElementsByClassName("leaflet-tile-pane"),S=b&&b[0].cloneNode(!0);if(S.style.zIndex=-9999,document.body.appendChild(S),S.style.overflow="hidden",S){let t=[].slice.call(S.getElementsByClassName("leaflet-layer"),0);t.sort((function(e,t){return Number.parseFloat(e.style.zIndex)-Number.parseFloat(t.style.zIndex)}));let i=this.getCanvas(),p=i&&i.getContext("2d");if(!p)return;p.clearRect(0,0,i.width,i.height);let l=function(e){for(let t=0;t<e.children.length;t++)if(e.children[t])for(let s=0;s<e.children[t].children.length;s++)e.children[t].children[s]&&"IMG"===e.children[t].children[s].tagName&&(e.children[t].children[s].style.position="absolute",e.children[t].children[s].style.left=e.children[t].children[s].getBoundingClientRect().left+y+f[0]+"px",e.children[t].children[s].style.top=e.children[t].children[s].getBoundingClientRect().top+f[1]+"px",e.children[t].children[s].style.transform="none")},h=t.map((t=>{let s=this.refs.canvas.cloneNode();return s.width=s.width+y,l(t),d()(t,{canvas:s,logging:!1,proxy:this.proxy,allowTaint:e&&e.allowTaint,useCORS:e&&e.allowTaint})}),this);h=[this.refs.canvas,...h],g.Promise.all(h).then((p=>{let l=p.reduce(((e,s,n)=>{let a=t[n-1];if(void 0===a)return e;let o=e.getContext("2d");return a.style&&!isNaN(Number.parseFloat(a.style.opacity))?o.globalAlpha=Number.parseFloat(a.style.opacity):o.globalAlpha=1,o.drawImage(s,-1*y,0),e})),h=()=>{document.body.removeChild(S);let t=this.mapDiv.getElementsByClassName("leaflet-marker-pane");if(t&&t.length>0){let s=this.refs.canvas.cloneNode();s.width=s.width+y,d()(t,{canvas:s,logging:!1,proxy:this.proxy,allowTaint:e&&e.allowTaint,useCORS:e&&e.allowTaint}).then((e=>{let t=l.getContext("2d");t.globalAlpha=1,t.drawImage(e,-1*y,0),this.props.onStatusChange("READY",this.isTainted(l)),this.props.onSnapshotReady(i,null,null,null,this.isTainted(l))}))}else this.props.onStatusChange("READY",this.isTainted(l)),this.props.onSnapshotReady(i,null,null,null,this.isTainted(l))};if(u){let e=document.createElement("canvas");s=s||0,n=n||0,e.setAttribute("width",Number.parseFloat(o)+y),e.setAttribute("height",a),m()(e,r,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:s,offsetY:n,renderCallback:()=>{l.getContext("2d").drawImage(e,-1*y,0),h()}})}else h()}))}})),b(this,"isTainted",(e=>{let t=(e||this.refs.canvas).getContext("2d");try{return t.getImageData(0,0,1,1),!1}catch(e){return 18===e.code}})),b(this,"exportImage",(()=>this.refs.canvas.toDataURL())),b(this,"outerHTML",(e=>{const t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}))}componentDidMount(){this.mapDiv=document.getElementById(this.props.mapId),this.proxy=null;let e=(0,p.b)();e&&("object"==typeof e&&(e=e.url),this.proxy=-1!==e.indexOf("?url=")?e.replace("?url=",""):e),!this.mapIsLoading(this.props.layers)&&this.props.active&&(this.props.onStatusChange("SHOTING"),this.triggerShooting(this.props.timeout))}UNSAFE_componentWillReceiveProps(e){let t=this.mapIsLoading(e.layers),s=this.mapChanged(e);this.previousTimeout&&clearTimeout(this.previousTimeout),e.active&&!t&&s?this.props.onStatusChange("SHOTING"):e.active||(this.props.onStatusChange("DISABLED"),this.props.snapstate.error&&this.props.onSnapshotError(null))}shouldComponentUpdate(e){return this.mapChanged(e)||this.props.snapstate!==e.snapstate}componentDidUpdate(e){let t=this.mapIsLoading(this.props.layers),s=this.mapChanged(e);!this.props.active||t||!s&&"SHOTING"!==this.props.snapstate.state||this.triggerShooting(this.props.timeout)}componentWillUnmount(){this.previousTimeout&&clearTimeout(this.previousTimeout)}render(){return r().createElement("canvas",{width:this.props.config&&this.props.config.size?this.props.config.size.width:"100%",height:this.props.config&&this.props.config.size?this.props.config.size.height:"100%",style:{maxWidth:"400px",maxHeight:"400px"},ref:"canvas"})}}b(S,"propTypes",{config:i.ZP.PropTypes.config,layers:a().array,snapstate:a().object,active:a().bool,onSnapshotReady:a().func,onStatusChange:a().func,onSnapshotError:a().func,allowTaint:a().bool,browser:a().object,canvas:a().node,timeout:a().number,drawCanvas:a().bool,mapId:a().string}),b(S,"defaultProps",{config:null,layers:[],snapstate:{state:"DISABLED"},active:!1,onSnapshotReady:()=>{},onStatusChange:()=>{},onSnapshotError:()=>{},browser:{},canvas:r().createElement("canvas",null),drawCanvas:!0,mapId:"map",timeout:2e3});const E=S},630992:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});const n=s(726413).Z},446931:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var n=s(893379),a=s.n(n),o=s(546290);a()(o.Z,{insert:"head",singleton:!1}),o.Z.locals,s(532454);var r=s(727418),i=s.n(r),p=s(45697),l=s.n(p),h=s(124852),c=s.n(h),d=s(234228),u=s(918141);function m(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class g extends c().Component{constructor(){super(...arguments),m(this,"renderLayers",(e=>{if(e){let t=this.props.config.projection||"EPSG:3857",s=this;return e.map(((e,n)=>{var a=i()({},e,{srs:t},"wms"===e.type?{forceProxy:!this.props.allowTaint}:{});return c().createElement(u.LLayer,{type:e.type,position:n,key:e.id||e.name,options:a},s.renderLayerContent(e))}))}return null})),m(this,"renderLayerContent",(e=>e.features&&"vector"===e.type?e.features.map((e=>c().createElement(u.Feature,{key:e.id,type:e.type,geometry:e.geometry}))):null)),m(this,"layerLoad",(()=>{if(this.toLoad--,0===this.toLoad){let e=this.refs.snapMap?this.refs.snapMap.map:null;e&&e.once("postrender",(e=>setTimeout((()=>{let t=e.map&&e.map.getTargetElement()&&e.map.getTargetElement().getElementsByTagName("canvas")[0];t&&this.createSnapshot(t)}),500)))}})),m(this,"layerLoading",(()=>{"SHOTING"!==this.props.snapstate.state&&this.props.onStatusChange("SHOTING"),this.toLoad=this.toLoad?this.toLoad:0,this.toLoad++})),m(this,"createSnapshot",(e=>{this.props.onSnapshotReady(e,null,null,null,this.isTainted(e))})),m(this,"isTainted",(e=>{if(e){let t=e.getContext("2d");try{return t.getImageData(0,0,1,1),!1}catch(e){return 18===e.code}}return!1}))}shouldComponentUpdate(e){return e.active||e.active!==this.props.active}componentDidUpdate(){this.props.active||(this.props.onStatusChange("DISABLED"),this.props.snapstate.error&&this.props.onSnapshotError(null))}render(){return this.props.active?c().createElement(u.LMap,{id:"snapshot_hidden_map-"+this.props.id,className:"snapshot_hidden_map",style:{width:this.props.config&&this.props.config.size?this.props.config.size.width:"100%",height:this.props.config&&this.props.config.size?this.props.config.size.height:"100%"},center:this.props.config.center,zoom:this.props.config.zoom,mapStateSource:this.props.config.mapStateSource,projection:this.props.config.projection||"EPSG:3857",zoomControl:!1,onLayerLoading:this.layerLoading,onLayerLoad:this.layerLoad,ref:"snapMap"},this.renderLayers(this.props.layers)):null}}m(g,"propTypes",{id:l().node,config:d.ZP.PropTypes.config,layers:l().array,snapstate:l().object,active:l().bool,onSnapshotReady:l().func,onStatusChange:l().func,onSnapshotError:l().func,allowTaint:l().bool}),m(g,"defaultProps",{config:null,layers:[],snapstate:{state:"DISABLED"},active:!1,onSnapshotReady:()=>{},onStatusChange:()=>{},onSnapshotError:()=>{}});var y=s(331655),v=s(618446),f=s.n(v);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class S extends c().Component{constructor(){super(...arguments),b(this,"getCanvas",(()=>this.refs.canvas)),b(this,"mapChanged",(e=>!f()(e.layers,this.props.layers)||e.active!==this.props.active||e.config!==this.props.config)),b(this,"mapIsLoading",(e=>e.some((e=>e.visibility&&e.loading)))),b(this,"triggerShooting",(e=>{this.previousTimeout&&clearTimeout(this.previousTimeout),this.previousTimeout=setTimeout((()=>{this.doSnapshot()}),e)})),b(this,"doSnapshot",(()=>{var e=document.getElementById(this.props.mapId);let t=e&&e.getElementsByTagName("canvas")[0];if(t&&this.getCanvas()){let e=this.getCanvas(),s=e.getContext("2d");s.clearRect(0,0,e.width,e.height),s.drawImage(t,0,0),this.props.onSnapshotReady(t),this.props.onStatusChange("READY",this.isTainted(t))}})),b(this,"isTainted",(e=>{let t=(e||this.refs.canvas).getContext("2d");try{return t.getImageData(0,0,1,1),!1}catch(e){return 18===e.code}})),b(this,"exportImage",(()=>this.refs.canvas.toDataURL()))}componentDidMount(){this.proxy=null;let e=(0,y.b)();e&&("object"==typeof e&&(e=e.url),this.proxy=-1!==e.indexOf("?url=")?e.replace("?url=",""):e),!this.mapIsLoading(this.props.layers)&&this.props.active&&(this.props.onStatusChange("SHOTING"),this.triggerShooting(this.props.timeout))}UNSAFE_componentWillReceiveProps(e){this.previousTimeout&&clearTimeout(this.previousTimeout),e.active||(this.props.onStatusChange("DISABLED"),this.props.snapstate.error&&this.props.onSnapshotError(null))}shouldComponentUpdate(e){return this.mapChanged(e)||this.props.snapstate!==e.snapstate}componentDidUpdate(e){let t=this.mapIsLoading(this.props.layers),s=this.mapChanged(e);t||!this.props.active||!s&&"SHOTING"!==this.props.snapstate.state||("SHOTING"!==this.props.snapstate.state&&this.props.onStatusChange("SHOTING"),this.triggerShooting(this.props.timeout))}componentWillUnmount(){this.previousTimeout&&clearTimeout(this.previousTimeout)}render(){return c().createElement("canvas",{width:this.props.config&&this.props.config.size?this.props.config.size.width:"100%",height:this.props.config&&this.props.config.size?this.props.config.size.height:"100%",style:{maxWidth:"400px",maxHeight:"400px",width:"100%",visibility:this.props.active?"block":"none"},ref:"canvas"})}}b(S,"propTypes",{config:d.ZP.PropTypes.config,layers:l().array,snapstate:l().object,active:l().bool,onSnapshotReady:l().func,onStatusChange:l().func,onSnapshotError:l().func,allowTaint:l().bool,browser:l().object,canvas:l().node,timeout:l().number,drawCanvas:l().bool,mapId:l().string}),b(S,"defaultProps",{config:null,layers:[],snapstate:{state:"DISABLED"},active:!1,onSnapshotReady:()=>{},onStatusChange:()=>{},onSnapshotError:()=>{},browser:{},canvas:c().createElement("canvas",null),drawCanvas:!0,mapId:"map",timeout:0});const E={GrabMap:g,Preview:S}},918141:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Feature:()=>l,LLayer:()=>h,LMap:()=>c,MeasurementSupport:()=>d,Overview:()=>u,ScaleBar:()=>m,default:()=>g});var n=s(278426),a=s(877758),o=s(323113),r=s(36624),i=s(904101),p=s(37525);const l=n.Z,h=a.Z,c=o.Z,d=r.Z,u=i.Z,m=p.Z,g={LLayer:h,LMap:c,MeasurementSupport:d,Overview:u,ScaleBar:m,Feature:l}},291635:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ne});var n=s(124852),a=s.n(n),o=s(630294),r=s(171703),i=s(22222),p=s(152543),l=s(687753),h=s(685476);const c="CHANGE_SNAPSHOT_STATE",d="SNAPSHOT_ERROR",u="SNAPSHOT_READY",m="SNAPSHOT_ADD_QUEUE",g="SNAPSHOT_REMOVE_QUEUE";function y(e){return(0,h.RP)(e,"snapshot.png","image/png"),{type:"SAVE_IMAGE",dataURL:e}}var v=s(893379),f=s.n(v),b=s(150737);f()(b.Z,{insert:"head",singleton:!1}),b.Z.locals;var S=s(618446),E=s.n(S),w=s(45697),T=s.n(w),C=s(234228),x=s(23888),I=s(131400),N=s(804504),L=s(590504),P=s(466737);function R(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s.e(5716).then(s.bind(s,365716));class D extends a().Component{render(){return a().createElement("div",{className:"spinner"},a().createElement("div",{className:"spinner-card "+this.props.sSize},a().createElement("div",{className:"spinner-bg spinner-loader"},"Loading.."),a().createElement("div",{className:"spinner-fg"},this.props.value)))}}R(D,"propTypes",{id:T().string,value:T().number,sSize:T().string}),R(D,"defaultProps",{id:"mapstore-basicspinner",value:null,sSize:null});const O=D;var B=s(805025),M=s.n(B),Z=s(936817),A=s.n(Z);const G=e=>{const t=s(792806)("./"+e+"/SnapshotSupport").default;return t.default||t};var z=s(442553);function k(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let j;class _ extends a().Component{constructor(){super(...arguments),k(this,"renderLayers",(()=>this.props.layers.map(((e,t)=>e.visibility?a().createElement("li",{key:t},e.title):null)))),k(this,"renderButton",(e=>a().createElement(x.Z,{bsStyle:this.props.buttonStyle,bsSize:"xs",disabled:!e,onClick:this.onClick},a().createElement(o.Glyphicon,{glyph:"floppy-save",disabled:{}})," ",a().createElement(N.Z,{msgId:this.props.saveBtnText})))),k(this,"renderError",(()=>this.props.snapshot.error?a().createElement(o.Row,{className:"text-center",style:{marginTop:"5px"}},a().createElement("h4",null,a().createElement("span",{className:"label label-danger"}," ",this.props.snapshot.error))):this.isBingOrGoogle()?a().createElement(o.Row,{className:"text-center",style:{marginTop:"5px"}},a().createElement("h4",null,a().createElement("span",{className:"label label-danger"},this.getgoogleBingError()))):null)),k(this,"mapIsLoading",(e=>e.some((e=>e.loading)))),k(this,"renderPreview",(()=>{if(!j.Preview)return a().createElement("div",{className:"snapshot-notsupported"},a().createElement(N.Z,{msgId:"snapshot.notsupported"}));let e,t=this.isBingOrGoogle(),s=this.isSnapshotReady();return e=t?M():A(),[a().createElement("div",{style:{display:s&&!t?"block":"none"},key:"snapshotPreviewContainer"},t?null:a().createElement(j.Preview,{ref:"snapshotPreview",timeout:this.props.timeout,config:this.props.map,layers:this.props.layers.filter((e=>e.visibility)),snapstate:this.props.snapshot,onStatusChange:this.props.onStatusChange,active:this.props.active&&!t,allowTaint:!0,drawCanvas:s&&!t,browser:this.props.browser})),a().createElement(o.Image,{key:"snapshotLoader",src:e,style:{margin:"0 auto",display:s&&!t?"none":"block"},responsive:!0})]})),k(this,"renderSize",(()=>{const e=this.props.map&&this.props.map.size||{width:100,height:100};return e.width+" X "+e.height})),k(this,"renderSnapshotQueue",(()=>this.props.snapshot.queue&&this.props.snapshot.queue.length>0?a().createElement("div",{key:"counter",style:{margin:"20px"}},this.renderDownloadMessage(),a().createElement(O,{value:this.props.snapshot.queue.length})," "):null)),k(this,"renderDownloadMessage",(()=>a().createElement(N.Z,{msgId:this.props.downloadingMsg}))),k(this,"wrap",(e=>this.props.floatingPanel?a().createElement(P.Z,null,a().createElement(L.Z,{id:"mapstore-snapshot-panel",style:this.props.panelStyle,bounds:this.props.bounds},a().createElement("span",{role:"header"},a().createElement("span",{className:"snapshot-panel-title"},a().createElement(N.Z,{msgId:"snapshot.title"})),a().createElement("button",{onClick:this.props.toggleControl,className:"print-panel-close close"},this.props.closeGlyph?a().createElement(o.Glyphicon,{glyph:this.props.closeGlyph}):a().createElement("span",null,"×"))),e)):a().createElement(o.Panel,{id:this.props.id,header:a().createElement(z.Z,{position:"right",bsStyle:"primary",title:a().createElement(N.Z,{msgId:"snapshot.title"}),glyph:"camera",onClose:this.props.toggleControl}),style:this.props.panelStyle,className:this.props.panelClassName},e))),k(this,"renderTaintedMessage",(()=>this.props.snapshot&&this.props.snapshot&&this.props.snapshot.tainted?a().createElement(o.Alert,{bsStyle:"warning"},a().createElement(N.Z,{msgId:"snapshot.taintedMessage"})):null)),k(this,"onClick",(()=>{if(this.refs.snapshotPreview.isTainted())this.createSnapshot();else{let e=this.refs.snapshotPreview.exportImage();this.props.downloadImg(e)}})),k(this,"createSnapshot",(()=>{this.props.onCreateSnapshot({key:(new Date).getTime(),config:this.props.map,layers:this.props.layers.filter((e=>e.visibility)),snapstate:this.props.snapshot,active:this.props.active,allowTaint:!1,drawCanvas:!0,browser:this.props.browser})})),k(this,"isBingOrGoogle",(()=>this.props.layers.some((e=>"google"===e.type&&e.visibility||"bing"===e.type&&e.visibility)))),k(this,"getgoogleBingError",(()=>a().createElement(N.Z,{msgId:this.props.googleBingErrorMsg}))),k(this,"isSnapshotReady",(()=>"READY"===this.props.snapshot.state&&!this.mapIsLoading(this.props.layers)&&this.props.map&&this.props.map.size))}UNSAFE_componentWillMount(){j=G(this.props.mapType)}UNSAFE_componentWillReceiveProps(e){e.mapType!==this.props.mapType&&(j=G(e.mapType))}shouldComponentUpdate(e){return!E()(e.layers,this.props.layers)||e.active!==this.props.active||e.map!==this.props.map||this.props.snapshot!==e.snapshot}render(){let e=this.isBingOrGoogle(),t=this.isSnapshotReady();return this.props.active?this.wrap(a().createElement(o.Grid,{role:"body",className:"snapshot-inner-panel",fluid:!0},a().createElement(o.Row,{key:"main"},a().createElement(o.Col,{key:"previewCol",xs:7,sm:7,md:7},this.renderPreview()),a().createElement(o.Col,{key:"dataCol",xs:5,sm:5,md:5},a().createElement(o.Table,{responsive:!0},a().createElement("tbody",null,a().createElement("tr",null,a().createElement("td",null,a().createElement(N.Z,{msgId:"snapshot.date"})),a().createElement("td",null," ",a().createElement(I.t6,{dateParams:this.props.dateFormat}))),a().createElement("tr",null,a().createElement("td",null,a().createElement(N.Z,{msgId:"snapshot.layers"})),a().createElement("td",null,a().createElement("ul",null,this.renderLayers()))),a().createElement("tr",null,a().createElement("td",null,a().createElement(N.Z,{msgId:"snapshot.size"})),a().createElement("td",null,this.renderSize())))))),this.renderError(),a().createElement(o.Row,{key:"buttons",htopclassName:"pull-right",style:{marginTop:"5px"}},this.renderButton(!e&&t),this.renderTaintedMessage(),this.renderSnapshotQueue()))):null}}k(_,"propTypes",{id:T().string,name:T().oneOfType([T().string,T().element]),saveBtnText:T().oneOfType([T().string,T().element]),map:C.ZP.PropTypes.config,layers:T().array,img:T().object,snapshot:T().object,active:T().bool,status:T().string,browser:T().object,onStatusChange:T().func,onCreateSnapshot:T().func,downloadImg:T().func,serviceBoxUrl:T().string,dateFormat:T().object,googleBingErrorMsg:T().node,downloadingMsg:T().node,timeout:T().number,mapType:T().string,floatingPanel:T().bool,panelStyle:T().object,panelClassName:T().string,toggleControl:T().func,style:T().object,closeGlyph:T().string,buttonStyle:T().string}),k(_,"defaultProps",{id:"snapshot_panel",layers:[],snapshot:{state:"DISABLED",img:{}},browser:{},icon:a().createElement(o.Glyphicon,{glyph:"camera"}),onStatusChange:()=>{},onCreateSnapshot:()=>{},toggleControl:()=>{},downloadImg:()=>{},saveBtnText:"snapshot.save",serviceBoxUrl:null,dateFormat:{day:"numeric",month:"long",year:"numeric"},googleBingErrorMsg:"snapshot.googleBingError",downloadingMsg:"snapshot.downloadingSnapshots",timeout:1e3,mapType:"leaflet",floatingPanel:!0,panelStyle:{minWidth:"600px",maxWidth:"100%",zIndex:100,position:"absolute",overflow:"auto",top:"60px",right:"100px"},panelClassName:"snapshot-panel ms-side-panel",closeGlyph:"1-close",buttonStyle:"primary",bounds:"#container"});const U=_;function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},H.apply(this,arguments)}function F(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let q;class W extends a().Component{constructor(){super(...arguments),F(this,"renderGrabMaps",(e=>e.map((e=>a().createElement(q.GrabMap,H({id:e.key,active:!0,snapstate:"SHOOTING",timeout:0,onSnapshotReady:t=>{this.saveImage(t,e)}},e)))))),F(this,"saveImage",((e,t)=>{try{this.props.onSnapshotError();let s=e.toDataURL();this.props.onRemoveSnapshot(t),setTimeout((()=>{this.props.downloadImg(s)}),0)}catch(e){this.props.onSnapshotError("Error saving snapshot"),this.props.onRemoveSnapshot(t)}}))}UNSAFE_componentWillMount(){q=G(this.props.mapType)}UNSAFE_componentWillReceiveProps(e){e.mapType!==this.props.mapType&&(q=G(e.mapType))}render(){return void 0!==this.props.queue&&this.props.queue.length>0?a().createElement("div",{className:"snapshot_hidden_map"},a().createElement("div",{key:"hiddenGrabMaps",style:{zIndex:-9999}},this.renderGrabMaps(this.props.queue))):a().createElement("noscript",null)}}F(W,"propTypes",{queue:T().array,browser:T().string,onRemoveSnapshot:T().func,onSnapshotError:T().func,downloadImg:T().func,mapType:T().string}),F(W,"contextTypes",{messages:T().object}),F(W,"defaultProps",{onRemoveSnapshot:()=>{},onSnapshotError:()=>{},mapType:"leaflet"});const Y=W;var X=s(727418),Q=s.n(X);var V=s(612912),$=s(274363),J=s(101092),K=s(488400);const ee=(0,i.P1)([$.Od,J.$v,V.l2,e=>e.controls&&e.controls.toolbar&&"snapshot"===e.controls.toolbar.active||e.controls.snapshot&&e.controls.snapshot.enabled,e=>e.browser,e=>e.snapshot||{queue:[]}],((e,t,s,n,a,o)=>({map:e,mapType:t,layers:s,active:n,browser:a,snapshot:o}))),te=(0,r.connect)(ee,{onCreateSnapshot:function(e){return{type:m,options:e}},onStatusChange:function(e,t){return{type:c,state:e,tainted:t}},downloadImg:y,toggleControl:l.Xi.bind(null,"snapshot",null)})(U),se=(0,r.connect)((e=>({queue:e.snapshot&&e.snapshot.queue||[]})),{downloadImg:y,onSnapshotError:function(e){return{type:d,error:e}},onRemoveSnapshot:function(e){return{type:g,options:e}}})(Y),ne=(0,p.rx)("SnapshotPlugin",{component:e=>a().createElement(a().Fragment,null,a().createElement(te,e),a().createElement(se,e)),containers:{Toolbar:{name:"snapshot",position:8,help:a().createElement(K.Z,{msgId:"helptexts.snapshot"}),tooltip:"snapshot.tooltip",icon:a().createElement(o.Glyphicon,{glyph:"camera"}),toggle:!0,doNotHide:!0,title:"snapshot.title",priority:1},BurgerMenu:{name:"snapshot",position:3,text:a().createElement(K.Z,{msgId:"snapshot.title"}),icon:a().createElement(o.Glyphicon,{glyph:"camera"}),action:l.Xi.bind(null,"snapshot",null),priority:3},SidebarMenu:{name:"snapshot",position:3,text:a().createElement(K.Z,{msgId:"snapshot.title"}),icon:a().createElement(o.Glyphicon,{glyph:"camera"}),tooltip:"snapshot.tooltip",action:l.Xi.bind(null,"snapshot",null),doNotHide:!0,toggle:!0,priority:2}},reducers:{snapshot:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c:return Q()({},e,{state:t.state,tainted:t.tainted});case u:return Q()({},e,{img:{data:t.imgData,width:t.width,height:t.height,size:t.size}});case d:return Q()({},e,{error:t.error});case m:{let s=[];return s=e&&void 0!==e.queue?[...e.queue,t.options]:[t.options],Q()({},e,{queue:s})}case g:{let s=e.queue||[];return s=s.filter((e=>e.key!==t.options.key)),Q()({},e,{queue:s})}default:return e}}}})},555198:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(923645),a=s.n(n)()((function(e){return e[1]}));a.push([e.id,"  .ms2 .snapshot_hidden_map{\n            position:absolute;\n            width: 100%;\n            height: 100%;\n            margin: 0;\n            padding: 0;\n            visibility: hidden;\n            overflow: hidden;\n            z-index:-1000;\n        }\n",""]);const o=a},546290:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(923645),a=s.n(n)()((function(e){return e[1]}));a.push([e.id,"  .ms2 .snapshot_hidden_map{\n            position:absolute;\n            width: 100%;\n            height: 100%;\n            margin: 0;\n            padding: 0;\n            visibility: hidden;\n            overflow: hidden;\n            z-index:-1000;\n        }\n",""]);const o=a},150737:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(923645),a=s.n(n)()((function(e){return e[1]}));a.push([e.id,".ms2 .snapshot-inner-panel{\n    width: 100%;\n}\n.ms2 .snapshot-inner-panel ul {\n    list-style:none;\n    padding-left:0;\n}\n\n.ms2 #mapstore-snapshot-panel {\n    position: absolute;\n    right: 200px;\n    min-width: 725px;\n}\n\n.ms2 .snapshot-panel .panel-heading {\n    padding: 0;\n}\n",""]);const o=a},805025:(e,t,s)=>{e.exports=s.p+"web/client/components/mapcontrols/Snapshot/not-available.png"},936817:(e,t,s)=>{e.exports=s.p+"web/client/components/mapcontrols/Snapshot/shoting.gif"},792806:(e,t,s)=>{var n={"./cesium/SnapshotSupport":692741,"./leaflet/SnapshotSupport":239177,"./openlayers/SnapshotSupport":446931};function a(e){var t=o(e);return s(t)}function o(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=792806}}]);