(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6949],{811256:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Q});var s=n(124852),o=n.n(s),i=n(45697),l=n.n(i),r=n(171703),a=n(867076),p=n(22222),c=n(36549),d=n(630294),u=n(952273),g=n(492838),h=n(313311),m=n.n(h),f=n(630998),b=n.n(f),y=n(189734),w=n.n(y);const v=e=>!e.dataGrid||!e.dataGrid.static,P=(0,p.P1)(u.zm,u.YR,u.yZ,u.lF,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return w()(e.filter(v).map((e=>b()(t,(t=>t===e.id))>=0?{...e,collapsed:!0}:e)),(e=>{const t=s[e.id]&&s[e.id].layout,o=m()(n,{i:e.id})||t||{},{x:i=0,y:l=0}=o;return 100*l+i}))}));var O=n(725211);const x=(0,a.compose)((0,a.defaultProps)({toolsOptions:{seeHidden:"user.role===ADMIN"}}),(0,O.Z)("toolsOptions",{asObject:!0}),(0,a.withProps)((e=>{let{widgets:t,toolsOptions:n={seeHidden:!1}}=e;return{widgets:n.seeHidden?t:t.filter((e=>!e.hide))}})));var E=n(756435),C=n(8204);const T=function(){let{widgetType:e,type:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=e&&"chart"!==e?e:t;switch(n){case"text":return"sheet";case"table":return"features-grid";case"pie":return"pie-chart";case"line":return"1-line";case"map":return"1-map";case"counter":return"counter";default:return"stats"}},k=(0,a.compose)((0,a.withPropsOnChange)(["btnGroupProps"],(e=>{let{btnGroupProps:t}=e;return{btnGroupProps:{...t,className:"widgets-bar"+(t&&t.className?` ${t.className}`:"")}}})),(0,a.withPropsOnChange)(["widgets","onClick"],(e=>{let{widgets:t=[],onClick:n=(()=>{})}=e;return{buttons:t.map((e=>({glyph:T(e),tooltip:e.title,className:e.collapsed?"btn-tray":"btn-tray active",onClick:()=>n(e)})))}})))(C.Z),S=(0,a.compose)((0,r.connect)((0,p.P1)(P,(e=>({widgets:e}))),{onClick:g.f}),(0,a.defaultProps)({btnGroupProps:{className:"widgets-toolbar",style:{marginLeft:2,marginRight:2}}}),x,(0,a.withProps)((e=>{let{btnGroupProps:t={},btnDefaultProps:n={}}=e;return{btnGroupProps:{bsSize:"xsmall",...t},btnDefaultProps:{bsSize:"xsmall",...n||{}}}})))(k);var W=n(23888),I=n(350126),G=n(496259);function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},M.apply(this,arguments)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const j=(0,c.Z)(W.Z),F=function(){let{expanded:e,onClick:t=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(j,{tooltipId:e?"widgets.tray.collapseTray":"widgets.tray.expandTray",bsSize:"xsmall",bsStyle:"default",style:{borderColor:"transparent"},onClick:t},o().createElement(d.Glyphicon,{glyph:e?"chevron-right":"chevron-left"}))},A=(0,a.compose)((0,r.connect)((0,p.P1)(u.E5,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{widgets:e}})),{onClick:()=>(0,g.Ff)()}),x,(0,a.withProps)((e=>{let{widgets:t=[]}=e;return{shouldExpand:0===t.length}})))((function(){let{onClick:e=(()=>{}),shouldExpand:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(j,{tooltipId:t?"widgets.tray.expandAll":"widgets.tray.collapseAll",bsStyle:t?"primary":"success active",bsSize:"xsmall",onClick:e},o().createElement(d.Glyphicon,{glyph:"list"}))}));class N extends o().Component{render(){var e;return this.props.enabled?o().createElement("div",{className:"widgets-tray",style:{marginBottom:32,marginRight:((null===(e=this.props.layout)||void 0===e?void 0:e.right)??0)+65,bottom:0,right:0,position:"absolute"}},o().createElement(E.Z,{columns:[...this.props.isSingleWidgetLayout?[]:[o().createElement(F,{key:"collapse-tray",toolsOptions:this.props.toolsOptions,expanded:this.props.expanded,onClick:()=>this.props.setExpanded(!this.props.expanded)})],o().createElement(A,{key:"collapse-all",toolsOptions:this.props.toolsOptions}),...this.props.items.map((e=>e.tool))||[]]},this.props.expanded&&!this.props.isSingleWidgetLayout?o().createElement(S,{toolsOptions:this.props.toolsOptions}):null)):null}}Z(N,"propTypes",{enabled:l().bool,toolsOptions:l().object,items:l().array,expanded:l().bool,setExpanded:l().func,layout:l().object,isSingleWidgetLayout:l().bool}),Z(N,"defaultProps",{enabled:!0,items:[],expanded:!1,setExpanded:()=>{},layout:{}});const z=(0,a.compose)((e=>t=>o().createElement(G.Z,{handleWidth:!0},(function(){let{width:n,height:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(e,M({},t,{width:n,height:s}))}))),(0,a.withState)("expanded","setExpanded",!1),(0,r.connect)((0,p.P1)(P,(e=>e.browser&&e.browser.mobile),(e=>(0,I.ic)(e,{right:!0})),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{widgets:e,layout:n,isMobileAgent:t}})),{toggleTray:g.ep}),x,(0,a.withProps)((e=>{let{widgets:t=[]}=e;return{hasCollapsedWidgets:t.filter((function(){let{collapsed:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).length>0,hasTrayWidgets:t.length>0}})),(0,a.withProps)((e=>{let{isMobileAgent:t,width:n,singleWidgetLayoutBreakpoint:s=1024}=e;return{isSingleWidgetLayout:t||n<=s}})),(0,a.lifecycle)({componentDidMount(){this.props.toggleTray&&this.props.toggleTray(!0)},componentWillUnmount(){this.props.toggleTray&&this.props.toggleTray(!1)}}),(0,a.mapPropsStream)((e=>e.merge(e.distinctUntilKeyChanged("hasCollapsedWidgets").do((e=>{let{setExpanded:t=(()=>{}),hasCollapsedWidgets:n}=e;return t(n)})).ignoreElements()))),(0,a.withProps)((e=>{let{enabled:t,hasTrayWidgets:n}=e;return{enabled:t&&n}})))(N);var L=n(748928),V=n(49977),D=n.n(V),J=n(227361),_=n.n(J),H=n(69371),R=n(926854),U=n(504518),Y=n(333101),$=n(555994);const q=e=>((0,u.E5)(e)||[]).filter((e=>!_()(e,"dataGrid.static"))).length>0,B=e=>t=>t.take(1).switchMap((()=>D().Observable.of((0,U.um)({...e,autoDismiss:8,position:"tr",uid:"timeline-collapsed"})))).merge(t),K={collapseTimelineOnWidgetsEvents:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return D().Observable.merge(e.ofType(g.Ym,g.uU,R.ok,g.$A,g.Jm).filter((()=>q(t())&&(0,$.pn)(t())))).switchMap((()=>D().Observable.of((0,H.w2)(!0)))).let(B({title:"widgets.tray.notifications.collapsed.timelineTitle",message:"widgets.tray.notifications.collapsed.message"}))},collapseWidgetsOnTimelineEvents:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return D().Observable.merge(e.ofType(H.M5).filter((e=>{let{collapsed:t}=e;return!t})),e.ofType(Y.yS).filter((function(){let{newProperties:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.dimensions}))).filter((()=>q(t())&&(0,$.qJ)(t())&&(0,$.pn)(t()))).switchMap((()=>D().Observable.of((0,g.Ff)()))).let(B({title:"widgets.tray.notifications.collapsed.widgetsTitle",message:"widgets.tray.notifications.collapsed.message"}))},expandTimelineIfCollapsedOnTrayUnmount:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(g.yY,g.$A,R.ok).filter((()=>!(0,$.pn)(t())&&(0,$.qJ)(t()))).filter((()=>!q(t()))).switchMap((()=>D().Observable.of((0,H.w2)(!1))))}},Q={WidgetsTrayPlugin:(0,L.Z)(z),epics:K}},748928:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(22222),o=n(171703),i=n(350126),l=n(101092);const r=(0,o.connect)((0,s.P1)(i.Jz,i.VM,l.c0,((e,t,n)=>({enabled:!e&&!t&&!n}))))},725211:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var s=n(867076),o=n(171703),i=n(22222),l=n(274363),r=n(510644),a=n(227361),p=n.n(a),c=n(984596),d=n.n(c),u=n(66604),g=n.n(u),h=n(747037),m=n.n(h),f=n(701469),b=n.n(f);const y=e=>{let{accessInfo:t,postProcessValue:n,reduceFun:s}=e;return e=>{let o=d()(e),i=s;return o.length>1&&"__OR__"===o[0]&&(i=(e,t)=>e||t,o=o.slice(1)),o.map((e=>{let o=e;if(b()(o))return y({accessInfo:t,postProcessValue:n,reduceFun:s})(o);let i=!1;o&&m()(o)&&o.startsWith("!")&&(i=!0,o=o.substr(1));const l=e=>i?!e:e,r=m()(o)&&o.split(":");if(r&&r[0]){const e=r[0].split(/\!\=\=?/),s=r[0].split(/\=\=?\=?/);return e.length>1?l(n(p()(t,e[0]),o)!==e[1]):s.length>1?l(n(p()(t,s[0]),o)===s[1]):l(n(p()(t,r[0]),o))}return o})).reduce(i||((e,t)=>e&&t))}},w=function(e){let{asObject:t=!1,postProcessValue:n=(e=>e),reduceFun:o,accessInfo:i="accessInfo"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.withPropsOnChange)([e,i],(function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?{[e]:g()(s[e],y({accessInfo:s[i],postProcessValue:n,reduceFun:o}))}:{[e]:y({accessInfo:s[i],postProcessValue:n,reduceFun:o})(s[e])}}))},v=function(){return(0,s.compose)((0,o.connect)((0,i.P1)(l.J9,l._H,r.np,((e,t,n)=>({accessInfo:{mapId:e,mapInfo:t,user:n}})))),w(...arguments))}}}]);