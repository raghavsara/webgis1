(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[9392],{403410:(e,t,n)=>{"use strict";n.d(t,{hn:()=>o,yg:()=>r,vD:()=>a,jJ:()=>i,oy:()=>s,W:()=>l,B1:()=>p,fU:()=>d,cY:()=>u});const o="ADDITIONALLAYER:ADD_ADDITIONAL_LAYERS",r="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",a="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",i="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",s="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",o=arguments.length>3?arguments[3]:void 0;return{type:i,id:e,owner:t,actionType:n,options:o}},p=(e,t)=>({type:s,owner:e,options:t}),d=function(){let{id:e,owner:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:r,id:e,owner:t}},u=e=>({type:a,owner:e})},483058:(e,t,n)=>{"use strict";n.d(t,{fy:()=>o,gd:()=>r,zZ:()=>a,ZR:()=>i});const o="BOX_END",r="CHANGE_BOX_SELECTION_STATUS";function a(e){return{type:o,boxEndInfo:e}}function i(e){return{type:r,status:e}}},807170:(e,t,n)=>{"use strict";n.d(t,{F2:()=>o,fu:()=>r,NF:()=>a,WP:()=>i,_E:()=>s});const o="HIGHLIGHT_STATUS",r="UPDATE_HIGHLIGHTED",a="HIGHLIGHT:SET_HIGHLIGHT_FEATURES_PATH";function i(e){return{type:a,featuresPath:e}}function s(e,t){return{type:r,features:e,status:t}}},387869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var o=n(49977),r=n.n(o),a=n(91175),i=n.n(a),s=n(757660),l=n(687753),p=n(926854),d=n(546952),u=n(333101),c=n(612912),m=n(4143),g=n(943650),h=n(399790);const y={accessMetadataExplorer:e=>e.ofType(s.xT).switchMap((()=>r().Observable.of((0,l.Xg)("metadataexplorer","enabled",!0),(0,s.vw)(!1),(0,d.Dw)("default_map_backgrounds")))),addBackgroundPropertiesEpic:e=>e.ofType(s.oQ).switchMap((e=>{let{modalParams:t}=e;const n=r().Observable.of((0,s.$c)({...t,loading:!1}));return t.layer&&"wms"===t.layer.type?r().Observable.of((0,s.$c)({...t,loading:!0})).concat((0,g.kB)(t.layer).switchMap((e=>r().Observable.of((0,s.$c)({...t,loading:!1,capabilities:(0,h.IA)(e)})))).catch((()=>n))):n})),backgroundsListInit:e=>e.ofType(p.ok).switchMap((e=>{let{config:t}=e;const n=t.map&&t.map.backgrounds||[],o=(t.map&&t.map.layers||[]).filter((e=>"background"===e.group)),a=n.filter((e=>!!e.thumbnail)).map((e=>(0,u.He)(e.id,{thumbURL:(e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0];let o=new ArrayBuffer(t.length),r=new Uint8Array(o);for(let e=0;e<t.length;++e)r[e]=t.charCodeAt(e);return URL.createObjectURL(new Blob([o],{type:n}))})(e.thumbnail)}))),l=i()(o.filter((e=>e.visibility)));return r().Observable.of(...a.concat((0,s.M3)(n)),...l?[(0,s.ke)(l.id)]:[])})),setCurrentBackgroundLayerEpic:(e,t)=>e.ofType(s.Wv).switchMap((e=>{let{layerId:n}=e;const o=t.getState(),a=(0,c.CA)(o,n);return r().Observable.of(...a&&"background"===a.group?[(0,l.Xg)("backgroundSelector","tempLayer",a),(0,l.Xg)("backgroundSelector","currentLayer",a)]:[])})),backgroundAddedEpic:(e,t)=>e.ofType(s.gC).mergeMap((e=>{let{layerId:n}=e;const o=t.getState(),a=(0,c.CA)(o,n);return a?r().Observable.of((0,u.He)(a.id,{visibility:!0}),(0,s.ke)(a.id),(0,s.V3)()):r().Observable.empty()})),backgroundEditedEpic:(e,t)=>e.ofType(s.dG).mergeMap((e=>{let{layerId:n}=e;const o=t.getState();return(0,c.CA)(o,n)?r().Observable.of((0,s.V3)()):r().Observable.empty()})),backgroundRemovedEpic:(e,t)=>e.ofType(s.H_).mergeMap((e=>{let{backgroundId:n}=e;const o=t.getState(),a=(0,c.CA)(o,n),l=(0,m.TP)(o)||[],p=(0,c.DP)(o)||{},d=n===p.id?i()(l.filter((e=>e.id!==n&&!e.invalid))):p;return a?r().Observable.of((0,u.ZF)(n,"layers"),(0,u.He)(d.id,{visibility:!0}),(0,s.ke)(d.id)):r().Observable.empty()})),syncSelectedBackgroundEpic:e=>e.ofType(s.K2).take(1).switchMap((t=>{let{id:n}=t;return e.ofType(u.oE).filter((e=>{let{layer:t}=e;return t.id===n})).switchMap((()=>r().Observable.of((0,s.pW)(n)))).takeUntil(e.ofType(s.gC))}))}},882150:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ge});var o=n(45697),r=n.n(o),a=n(124852),i=n.n(a),s=n(152543);const l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=e,i=o,s=r,l=a;if({NODE_ENV:"production"}.isTest){const e={},t=t=>(e[t]=e[t]||{rootCount:0,iframesCreated:!1,timedOut:!1,fontLoaded:!1,requiredExtraTimeout:!1},e[t]);window.reporter=window.reporter||{modifyRootCount(e,n){t(e).rootCount+=n},iframesCreated(e){t(e).iframesCreated=!0},timedOut(e){t(e).timedOut=!0},fontLoaded(e){t(e).fontLoaded=!0},requiredExtraTimeout(e){t(e).requiredExtraTimeout=!0},getTests:()=>e}}n.timeoutAfter&&setTimeout((()=>{i&&({NODE_ENV:"production"}.isTest&&window.reporter.modifyRootCount(l,-1),document.body.removeChild(i),i=0,n.onTimeout&&({NODE_ENV:"production"}.isTest&&window.reporter.timedOut(l),n.onTimeout()))}),n.timeoutAfter),s=()=>{i&&i.firstChild.clientWidth===i.lastChild.clientWidth&&({NODE_ENV:"production"}.isTest&&window.reporter.modifyRootCount(l,-1),document.body.removeChild(i),i=0,{NODE_ENV:"production"}.isTest&&window.reporter.fontLoaded(l),t())},{NODE_ENV:"production"}.isTest&&window.reporter.modifyRootCount(l,1),{NODE_ENV:"production"}.isLegacy||s(document.body.appendChild(i=document.createElement("div")).innerHTML='<div style="position:fixed;white-space:pre;bottom:999%;right:999%;font:999px '+(n.generic?"":"'")+a+(n.generic?"":"'")+',serif">'+(n.sampleText||" ")+'</div><div style="position:fixed;white-space:pre;bottom:999%;right:999%;font:999px '+(n.generic?"":"'")+a+(n.generic?"":"'")+',monospace">'+(n.sampleText||" ")+"</div>"),{NODE_ENV:"production"}.isLegacy&&s(document.body.appendChild(i=document.createElement("div")).innerHTML='<table style=position:absolute;bottom:999%;right:999%;width:auto><tr><td style=position:relative><tr><td style="font:999px monospace;white-space:pre">.<span style="font:999px '+(n.generic?"":"'")+a+(n.generic?"":"'")+',serif">'+(n.sampleText||" ")+'</span>.</table><table style=position:absolute;bottom:999%;right:999%;width:auto><tr><td style=position:relative><tr><td style="font:999px monospace;white-space:pre">.<span style="font:999px '+(n.generic?"":"'")+a+(n.generic?"":"'")+',monospace">'+(n.sampleText||" ")+"</span>.</table>"),i&&({NODE_ENV:"production"}.isTest&&window.reporter.iframesCreated(l),{NODE_ENV:"production"}.isLegacy||(i.firstChild.appendChild(a=document.createElement("iframe")).style.width="999%",a.contentWindow.onresize=s,i.lastChild.appendChild(a=document.createElement("iframe")).style.width="999%",a.contentWindow.onresize=s),{NODE_ENV:"production"}.isLegacy&&(i.firstChild.firstChild.firstChild.firstChild.appendChild(a=document.createElement("iframe")).style.cssText="position:absolute;bottom:999%;right:999%;width:999%",a.attachEvent?a.contentWindow.attachEvent("onresize",s):a.contentWindow.onresize=s,i.lastChild.firstChild.firstChild.firstChild.appendChild(a=document.createElement("iframe")).style.cssText="position:absolute;bottom:999%;right:999%;width:999%",a.attachEvent?a.contentWindow.attachEvent("onresize",s):a.contentWindow.onresize=s),{NODE_ENV:"production"}.isTest||(a=setTimeout(s)),{NODE_ENV:"production"}.isTest&&(a=setTimeout((function(){i&&(window.reporter.requiredExtraTimeout(l),s())}))))};var p=n(472986),d=n.n(p),u=n(893379),c=n.n(u),m=n(92623);c()(m.Z,{insert:"head",singleton:!1}),m.Z.locals;var g=n(804504),h=n(234228),y=n(859518),f=n(747037),b=n.n(f),v=n(274363),E=n(101092),T=n(612912),w=n(227361),L=n.n(w),O=n(22222),C=n(351546);const S=e=>L()(e,e&&e.featuregrid&&e.featuregrid.open&&e.featuregrid.showFilteredObject?"query.filterObj.spatialField":"emptyObject"),x=e=>S(e)&&S(e).geometry,M=(0,O.P1)([e=>x(e)&&x(e).coordinates||[],e=>x(e)&&x(e).type||"Polygon",e=>x(e)&&x(e).id||"spatial_object",e=>x(e)&&x(e).projection||"EPSG:3857"],((e,t,n,o)=>{let r={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:t,coordinates:e},style:{fillColor:"#FFFFFF",fillOpacity:"0.2",color:"#ffcc33"},id:n}]};return e.length>0&&t?(0,C.reprojectGeoJson)(r,o,"EPSG:4326").features:[]})),A=(0,O.P1)([M,e=>L()(e,e&&e.highlight&&e.highlight.featuresPath||"highlight.emptyFeatures")||[]],((e,t)=>[...t,...e]));var k=n(510644),I=n(707366),P=n(665529),N=n(904160),D=n(618446),_=n.n(D);const F=(0,N.o)(_())(v.pb,v.Od,E.$v,T.Hi,A,(e=>e.mapInitialConfig&&e.mapInitialConfig.loadingError&&e.mapInitialConfig.loadingError.data),k.y8,v.zT,E.m6,P.wk,P.c3,I.KV,((e,t,n,o,r,a,i,s,l,p,d,u)=>({projectionDefs:e,map:t,mapType:n,layers:o,features:r,loadingError:a,securityToken:i,elevationEnabled:s,shouldLoadFont:l,isLocalizedLayerStylesEnabled:p,localizedLayerStylesName:d,currentLocaleLanguage:u})));var j=n(171703),Z=n(630294);const R=(0,O.P1)(v.Od,E.$v,E.c0,((e,t,n)=>({map:e,mapType:t,isCesium:n}))),H={updateConfigAction:y.aN},z=(0,j.connect)(R,H)((e=>{let{map:t,mapType:n,isCesium:o,updateConfigAction:r,mapOptions:a}=e;const s={...a&&a[n]||h.ZP.getConfigProp("defaultMapOptions")&&h.ZP.getConfigProp("defaultMapOptions")[n]||{},...null==t?void 0:t.mapOptions},l=(e,t)=>{r({[t]:!e[t]})};return o?i().createElement("form",null,i().createElement(Z.FormGroup,null,i().createElement(Z.ControlLabel,null,i().createElement(g.Z,{msgId:"map.settings.title"}))),i().createElement(Z.Checkbox,{checked:s.showSkyAtmosphere,onChange:()=>l(s,"showSkyAtmosphere")},i().createElement(g.Z,{msgId:"map.settings.skyAtmosphere"})),i().createElement(Z.Checkbox,{checked:s.showGroundAtmosphere,onChange:()=>l(s,"showGroundAtmosphere")},i().createElement(g.Z,{msgId:"map.settings.groundAtmosphere"})),i().createElement(Z.Checkbox,{checked:s.enableFog,onChange:()=>l(s,"enableFog")},i().createElement(g.Z,{msgId:"map.settings.fog"})),i().createElement(Z.Checkbox,{checked:s.depthTestAgainstTerrain,onChange:()=>l(s,"depthTestAgainstTerrain")},i().createElement(g.Z,{msgId:"map.settings.depthTest"}))):null}));var G=n(146619),B=n(815179),V=n(296252),U=n(727418),W=n.n(U);const Y={drawStatus:null,drawOwner:null,drawMethod:null,options:{},features:[],tempFeatures:[],snapping:!1,snappingIsLoading:!1,snappingLayer:!1},X={edge:!0,vertex:!0,pixelTolerance:10,strategy:"bbox"};var $=n(483058);const K={status:null};var J=n(807170);const q={status:"disabled",layer:"featureselector",features:[],highlighted:0,featuresPath:"highlight.emptyFeatures",emptyFeatures:[]};var Q=n(962565),ee=n(403410),te=n(91175),ne=n.n(te),oe=n(535937),re=n.n(oe),ae=n(406557),ie=n.n(ae),se=n(513218),le=n.n(se),pe=n(701469),de=n.n(pe);var ue=n(49977),ce=n.n(ue),me=n(333101),ge=n(926854),he=n(412961),ye=n(350126),fe=n(687753),be=n(399790),ve=n(835516),Ee=n(504518),Te=n(917450),we=n(66604),Le=n.n(we);const Oe={checkMapPermissions:(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(he.XP).filter((()=>(0,v.J9)(n()))).map((()=>{const e=(0,v.J9)(n());return(0,ge.I6)(e)}))},handleCreationLayerError:(e,t)=>e.ofType(y.TF).delay(500).switchMap((e=>{const n=(0,E.$v)(t.getState()),o=(0,T.CA)(t.getState(),e.options.id);return o&&(0,be.yJ)(o,n)?ce().Observable.from([(0,me.He)(e.options.id,{invalid:!0})]):ce().Observable.empty()})),handleCreationBackgroundError:(e,t)=>e.ofType(y.TF).delay(500).filter((e=>{const n=(0,T.x)(t.getState());return n&&e.options.id===n.id&&"background"===e.options.group})).switchMap((e=>{const n=(0,E.$v)(t.getState()),o=ne()((0,T.pV)(t.getState()).filter((t=>(0,be.yJ)(t,n)&&t.id!==e.options.id)));return o?ce().Observable.from([(0,me.He)(o.id,{visibility:!0}),(0,fe.Xg)("backgroundSelector","currentLayer",o),(0,fe.Xg)("backgroundSelector","tempLayer",o),(0,Ee.Kp)({title:"warning",message:"notification.backgroundLayerNotSupported",action:{label:"close"},position:"tc"})]):ce().Observable.of((0,Ee.Kp)({title:"warning",message:"notification.noBackgroundLayerSupported",action:{label:"close"},position:"tc"}))})),resetMapOnInit:e=>e.ofType(y.Ec).switchMap((()=>ce().Observable.of((0,ee.cY)(),(0,fe.fV)(),(0,me.nN)(),(0,Te.XP)()))),resetLimitsOnInit:(e,t)=>e.ofType(ge.ok,y.Li).switchMap((()=>{const e=(0,v.A0)(t.getState()),n=(0,v.zj)(t.getState()),o=(0,v.S)(t.getState());return ce().Observable.of((0,y.BV)({restrictedExtent:n,crs:e,minZoom:o}))})),zoomToExtentEpic:(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(y.Qy).switchMap((e=>{const t=(e=>{if(de()(e))return e.map((e=>"string"==typeof e||e instanceof String?Number(e):e));if(le()(e)){const t=Le()(e,(e=>"string"==typeof e||e instanceof String?Number(e):e));return[t.minx,t.miny,t.maxx,t.maxy]}return null})(e.extent);if(!t)return ce().Observable.empty();const o=ve.default.getHook(ve.default.ZOOM_TO_EXTENT_HOOK),r=(0,ye.CF)(n());if(o){const{crs:n,maxZoom:a,options:i={}}=e;return o(t,{crs:n,padding:r,maxZoom:a,...i}),ce().Observable.empty()}return((e,t)=>{let n=0,{extent:o=[]}=e,r=C.default.reprojectBbox(o,e.crs,t.bbox&&t.bbox.crs||"EPSG:4326");if(r){let a=C.default.reproject(ve.default.getCenterForExtent(o,e.crs),e.crs,"EPSG:4326");if("EPSG:4326"===e.crs&&o&&o[0]<=-180&&o[1]<=-90&&o[2]>=180&&o[3]>=90)n=1;else{let r=C.default.reprojectBbox(o,e.crs,t.projection||"EPSG:4326");n=ve.default.getZoomForExtent(r,t.size,0,21,null)}e.maxZoom&&n>e.maxZoom&&(n=e.maxZoom);let i={minx:r[0],miny:r[1],maxx:r[2],maxy:r[3]},s={...t.bbox,bounds:i};return ce().Observable.of((0,y.o6)(a,n,s,t.size,e.mapStateSource,t.projection,t.viewerOptions))}return ce().Observable.empty()})({...e,extent:t},(0,v.Od)(n()))}))}};var Ce=n(387305),Se=n(976719),xe=n(870820);function Me(e){return{type:"CHANGE_SELECTION_STATE",geomType:e.geomType,point:e.point,line:e.line,polygon:e.polygon}}var Ae=n(308602);const ke=()=>i().createElement("span",null);var Ie=n(117931),Pe=n(191332),Ne=n(867517),De=n(23888);const _e=function(e){let{show:t,error:n,onReload:o}=e;return t?i().createElement("div",{className:"ms-map-error-panel",style:{position:"absolute",width:"100%",height:"100%",color:"#ffffff",background:"rgba(0, 0, 0, 0.75)",zIndex:100,top:0,left:0,display:"flex",alignItems:"center",justifyContent:"center"}},i().createElement("div",{style:{maxWidth:500}},i().createElement("h1",null,i().createElement(Ne.Z,{msgId:"map.renderingErrorTitle"})),i().createElement("p",null,i().createElement(Ne.Z,{msgId:"map.renderingErrorMessage"})),(null==n?void 0:n.message)&&i().createElement(Z.Alert,{bsStyle:"danger"},i().createElement("small",null,n.message)),o&&i().createElement(De.Z,{bsStyle:"primary",onClick:()=>o()},i().createElement(g.Z,{msgId:"map.reloadMap"})))):null};var Fe=n(23939),je=n(387869),Ze=n(964091);function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Re.apply(this,arguments)}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ze extends i().Component{constructor(){super(...arguments),He(this,"state",{canRender:!0}),He(this,"getHighlightLayer",((e,t,n)=>{const o=this.state.plugins;return i().createElement(o.Layer,{type:"vector",srs:e,position:t,key:"highlight",options:{name:"highlight"},env:n},this.props.features.map((t=>i().createElement(o.Feature,{msId:t.id,key:t.id,crs:e,type:t.type,style:t.style||null,geometry:t.geometry}))))})),He(this,"getTool",(e=>b()(e)?{name:e,impl:this.state.plugins.tools[e]}:e[this.props.mapType]||e)),He(this,"getConfigMapOptions",(()=>this.props.mapOptions&&this.props.mapOptions[this.props.mapType]||h.ZP.getConfigProp("defaultMapOptions")&&h.ZP.getConfigProp("defaultMapOptions")[this.props.mapType]||{})),He(this,"renderLayers",(()=>{const e=this.props.map.projection||"EPSG:3857",t=[];this.props.isLocalizedLayerStylesEnabled&&t.push({name:this.props.localizedLayerStylesName,value:this.props.currentLocaleLanguage});const n=this.state.plugins;return[...this.props.layers,...this.props.additionalLayers].filter(this.filterLayer).map(((o,r)=>i().createElement(n.Layer,{type:o.type,srs:e,position:r,key:o.id||o.name,options:o,securityToken:this.props.securityToken,env:t},this.renderLayerContent(o,e)))).concat(this.props.features&&this.props.features.length&&this.getHighlightLayer(e,this.props.layers.length,t)||[])})),He(this,"renderLayerContent",((e,t)=>{const n=this.state.plugins;return e.features?e.features.filter((0,Pe.createFeatureFilter)(e.filterObj)).map((o=>i().createElement(n.Feature,{key:o.id,msId:o.id,type:o.type,crs:t,geometry:o.geometry,features:o.features,featuresCrs:e.featuresCrs||"EPSG:4326",layerStyle:e.style,style:o.style||e.style||null,properties:o.properties}))):null})),He(this,"renderSupportTools",(()=>{const e=this.props.items.filter((e=>{let{Tool:t}=e;return!!t})).map((e=>{let{Tool:t,name:n,cfg:o}=e;return i().createElement(t,Re({},o,{key:n,mapType:this.props.mapType}))}));return this.props.tools.map((e=>{const t=this.getTool(e),n=this.props.toolsOptions[t.name]&&this.props.toolsOptions[t.name][this.props.mapType]||this.props.toolsOptions[t.name]||{};return i().createElement(t.impl,Re({key:t.name},n))})).concat(e)})),He(this,"filterLayer",(e=>!e.useForElevation||"cesium"===this.props.mapType||this.props.elevationEnabled)),He(this,"updatePlugins",(e=>{this.currentMapType=e.mapType,e.onLoadingMapPlugins(!0),this.setState({plugins:void 0}),((e,t)=>Promise.all([n(657606)("./"+e+"/index"),n(188455)("./"+e+"/plugins/index")]).then((n=>{let[o]=n;const r=o.default,a=(0,j.connect)((e=>({projectionDefs:(0,v.pb)(e),mousePosition:(0,v.x9)(e)})),W()({},{onMapViewChanges:y.o6,onClick:y.FP,onMouseMove:y.ou,onLayerLoading:me.Yz,onLayerLoad:me.kI,onLayerError:me.XG,onWarning:Ee.Kp,onMouseOut:y.NE},t),((e,t,n)=>W()({},n,e,W()({},t,{onMouseMove:e.mousePosition?t.onMouseMove:()=>{}}))))(r.LMap),i=(0,j.connect)((e=>({enabled:e.controls&&e.controls.measure&&e.controls.measure.enabled||!1,measurement:(0,xe.VH)(e),useTreshold:e.measurement&&e.measurement.useTreshold||null,uom:e.measurement&&e.measurement.uom||{length:{unit:"m",label:"m"},area:{unit:"sqm",label:"m²"}}})),{changeMeasurementState:Se.nl,updateMeasures:Se.Y_,resetGeometry:Se.wB,changeGeometry:Se.$3,setTextLabels:Se.CG,changeMeasurement:Se.Bd})(r.MeasurementSupport||ke),s=(0,j.connect)((e=>({...e.draw??{},snappingLayerInstance:(0,Ae.lM)(e)})),{onChangeDrawingStatus:V.Yf,onEndDrawing:V.fo,onGeometryChanged:V.Vw,onSelectFeatures:V.KD,onDrawingFeatures:V.uj,onDrawStopped:V.lo,setCurrentStyle:V.PY,toggleSnappingIsLoading:V.sc})(r.DrawSupport||ke),l=(0,j.connect)((0,O.P1)((e=>(e=>e&&e.box&&e.box.status)(e)),(e=>({status:e}))),{onBoxEnd:$.zZ})(r.BoxSelectionSupport||ke),p=(0,j.connect)((e=>e.highlight||{}),{updateHighlighted:J._E})(r.HighlightFeatureSupport||ke),d=(0,j.connect)((e=>({selection:e.selection||{}})),{changeSelectionState:Me})(r.SelectionSupport||ke),u=(0,j.connect)(null,{onWarning:Ee.Kp})(r.Layer||ke),c=[],m=(0,j.connect)((0,O.P1)((e=>e.mapPopups&&e.mapPopups.popups||c),(e=>({popups:e}))),{onPopupClose:Ce.hC})(r.PopupSupport||ke);return{Map:a,Layer:u,Feature:r.Feature||ke,tools:{measurement:i,overview:r.Overview||ke,scalebar:r.ScaleBar||ke,draw:s,highlight:p,selection:d,popup:m,box:l},mapType:e}})))(e.mapType,e.actions).then((t=>{this._isMounted&&t.mapType===this.currentMapType&&(this.setState({plugins:t}),e.onLoadingMapPlugins(!1,e.mapType),e.onMapTypeLoaded(!0,e.mapType))}))}))}UNSAFE_componentWillMount(){const{shouldLoadFont:e,fonts:t}=this.props;e&&t&&(this.setState({canRender:!1}),Promise.all(t.map((e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,o)=>{l(e,n,{timeoutAfter:t.timeoutAfter,onTimeout:o,sampleText:t.sampleText,generic:t.generic})}))}(e,{timeoutAfter:5e3}).catch((e=>{console.warn("Fonts loading check for map style responded slowly or with an error. Fonts in map may not be rendered correctly. This is not necessarily an issue.",e)}))))).then((()=>{this.setState({canRender:!0})}))),this.updatePlugins(this.props),this._isMounted=!0}UNSAFE_componentWillReceiveProps(e){e.mapType===this.props.mapType&&e.actions===this.props.actions||this.updatePlugins(e)}componentWillUnmount(){this._isMounted=!1}render(){if(this.props.map&&this.state.canRender&&this.state.plugins){const{mapOptions:e={}}=this.props.map;return i().createElement(this.state.plugins.Map,Re({id:"map"},this.props.options,{projectionDefs:this.props.projectionDefs},this.props.map,{mapOptions:{...this.getConfigMapOptions(),...e},zoomControl:this.props.zoomControl,onResolutionsChange:this.props.onResolutionsChange,errorPanel:_e}),this.renderLayers(),this.renderSupportTools())}return this.props.loadingError?i().createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},className:"mapErrorMessage"},i().createElement(g.Z,{msgId:"map.loadingerror"}),":",this.props.loadingError):i().createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},className:"mapLoadingMessage"},this.props.loadingSpinner?i().createElement(d(),{spinnerName:"circle",overrideSpinnerClassName:"spinner"}):null,i().createElement(g.Z,{msgId:this.props.mapLoadingMessage}))}}He(ze,"propTypes",{mapType:r().string,map:r().object,layers:r().array,additionalLayers:r().array,zoomControl:r().bool,mapLoadingMessage:r().string,loadingSpinner:r().bool,loadingError:r().string,tools:r().array,fonts:r().array,options:r().object,mapOptions:r().object,projectionDefs:r().array,toolsOptions:r().object,onResolutionsChange:r().func,actions:r().object,features:r().array,securityToken:r().string,shouldLoadFont:r().bool,elevationEnabled:r().bool,isLocalizedLayerStylesEnabled:r().bool,localizedLayerStylesName:r().string,currentLocaleLanguage:r().string,items:r().array,onLoadingMapPlugins:r().func,onMapTypeLoaded:r().func}),He(ze,"defaultProps",{mapType:"leaflet",actions:{},zoomControl:!1,mapLoadingMessage:"map.loading",loadingSpinner:!0,tools:["measurement","scalebar","draw","highlight","popup","box"],options:{},mapOptions:{},fonts:["FontAwesome"],toolsOptions:{measurement:{},locate:{},scalebar:{leaflet:{position:"bottomright"}},overview:{overviewOpt:{position:"bottomright",collapsedWidth:25,collapsedHeight:25,zoomLevelOffset:-5,toggleDisplay:!0},layers:[{type:"osm"}]}},securityToken:"",additionalLayers:[],shouldLoadFont:!1,elevationEnabled:!1,onResolutionsChange:()=>{},items:[],onLoadingMapPlugins:()=>{},onMapTypeLoaded:()=>{}});const Ge=(0,s.rx)("Map",{component:(0,s.$j)(F,{onResolutionsChange:y.SO,onMapTypeLoaded:y.Mk})((0,Ie.Z)(ze)),reducers:{map:G.Z,layers:B.Z,draw:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case V.hZ:return W()({},t,{drawStatus:n.status,drawOwner:n.owner,drawMethod:n.method,options:n.options,features:n.features,style:n.style});case V.kD:return W()({},t,{currentStyle:n.currentStyle});case V.DI:return W()({},t,{tempFeatures:n.features});case V.IC:return W()({},t,{tempFeatures:[]});case V.G_:return{...t,snapping:!t.snapping};case V.uB:return{...t,snappingLayer:n.snappingLayer,snappingIsLoading:!1};case V.Rh:return{...t,snappingIsLoading:!t.snappingIsLoading};case V.vU:return{...t,snapConfig:{...{...X,...(null===(e=n.pluginCfg)||void 0===e?void 0:e.snapConfig)||{}},...(null==t?void 0:t.snapConfig)??{},...n.prop&&void 0!==n.value?{[n.prop]:n.value}:{}}};default:return t}},box:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;return t.type===$.gd?W()({},e,{status:t.status}):e},highlight:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J.NF:return W()({},e,{featuresPath:t.featuresPath||"highlight.emptyFeatures"});case J.F2:return{...e,status:t.status};case J.fu:return{...e,highlighted:t.features.length,features:t.features,status:t.status||e.status};default:return e}},maptype:Q.Z,additionallayers:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee.jJ:{const n=re()({id:t.id,owner:t.owner,actionType:t.actionType,options:t.options},ie()),o=ne()(e.filter((e=>{let{id:t}=e;return t===n.id})));return o?e.map((e=>e.id===n.id?{...o,...n}:{...e})):[...e,n]}case ee.hn:return e.concat(t.layers);case ee.oy:{const{options:n,owner:o}=t;return e.map(((e,t)=>e.owner===o?{...e,options:le()(n)&&n[e.id]||de()(n)&&n[t]||{}}:{...e}))}case ee.yg:{const{id:n,owner:o}=t;return o?e.filter((e=>e.owner!==o)):e.filter((e=>e.id!==n))}case ee.vD:return t.owner?e.filter((e=>e.owner!==t.owner)):[];default:return e}}},epics:{...Oe,...je.Z,...(0,Fe.Z)(Ze.Z)},containers:{Settings:()=>({tool:i().createElement(z,null),position:2})}})},308602:(e,t,n)=>{"use strict";n.d(t,{lM:()=>c,jP:()=>m,Qp:()=>g,l:()=>h,$N:()=>y});var o=n(227361),r=n.n(o),a=n(513218),i=n.n(a),s=n(612912),l=n(820709),p=n(904160),d=n(399790),u=n(707366);const c=e=>{var t;return!(null==e||null===(t=e.draw)||void 0===t||!t.snappingLayer)&&((0,s.CA)(e,e.draw.snappingLayer)??(0,s.iv)(e,e.draw.snappingLayer))},m=e=>r()(e,"draw.snapping",!1),g=e=>r()(e,"draw.snappingIsLoading",!1),h=e=>r()(e,"draw.snapConfig",!1),y=(0,p.o)(((e,t)=>e===t||i()(e)&&i()(t)&&(null==e?void 0:e.id)===(null==t?void 0:t.id)&&(null==e?void 0:e.title)===(null==t?void 0:t.title)))([s.l2,s.KL,l.Li,c,h,u.Pz],(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;const i=null==o?void 0:o.id,s=null==n?void 0:n.id,l=t.filter((e=>((null==r?void 0:r.additionalLayers)??[]).includes(e.id))).map((e=>e.options)),p=l.concat(e),u=s?[{value:s,label:(0,d.in)(n,a),active:s===i}]:[];return u.concat(p.map((e=>{var t;return!(e.id===s||!["wms","wfs","vector"].includes(null==e?void 0:e.type)||"wms"===(null==e?void 0:e.type)&&"wfs"!==(null==e||null===(t=e.search)||void 0===t?void 0:t.type)||"background"===e.group||!e.visibility)&&{value:e.id,label:(0,d.in)(e,a),active:e.id===i}})).filter(Boolean))}))},870820:(e,t,n)=>{"use strict";n.d(t,{JF:()=>p,iL:()=>d,cD:()=>u,jM:()=>c,VH:()=>g,on:()=>h});var o=n(101092),r=n(119008),a=n(521923),i=n(556233),s=n(227361),l=n.n(s);const p=e=>l()(e,"controls.measure.enabled"),d=e=>(0,r.Iz)(e)&&!e.measurement.isDrawing&&(0,o.m6)(e),u=e=>e&&e.measurement&&e.measurement.showAddAsAnnotation,c=e=>e&&e.measurement&&e.measurement.trueBearing&&e.measurement.trueBearing.measureTrueBearing,m=e=>{let t=e.measurement.feature||{};return t.geometry&&(t=(0,a.t8)("geometry.coordinates",(0,i.L0)(t.geometry||{}),t)),t},g=e=>e.measurement&&{...e.measurement,feature:m(e)}||{},h=e=>{var t;return null==e||null===(t=e.measurement)||void 0===t?void 0:t.geomType}},92623:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o=n(923645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,".ms2 .mapErrorMessage {\n    font-size: 16px;\n    color: red;\n}\n",""]);const a=r},188455:(e,t,n)=>{var o={"./cesium/plugins/index":[116854,9,8343,1250,6854],"./leaflet/plugins/index":[72183,7,5243,1263,2183],"./openlayers/plugins/index":[532454,9,778,5604,1324,5986,302,2514,7202,2454,3715,8551]};function r(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(2).map(n.e)).then((()=>n.t(r,16|t[1])))}r.keys=()=>Object.keys(o),r.id=188455,e.exports=r},657606:(e,t,n)=>{var o={"./cesium/index":[134748,8343,1250,9692,8401,8826],"./leaflet/index":[692621,5243,476,3726,5085,4175],"./openlayers/index":[546273,8471,778,1324,302,8256,2514,7849,5584,7202,6102,3026,3715,3965,2714]};function r(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(r)))}r.keys=()=>Object.keys(o),r.id=657606,e.exports=r}}]);