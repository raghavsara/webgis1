(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[4995],{178813:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>A});var s={};l.r(s),l.d(s,{closeDetailsPanelEpic:()=>P,fetchDataForDetailsPanel:()=>G,storeDetailsInfoEpic:()=>U});var a=l(124852),i=l.n(a),o=l(171703),n=l(227361),r=l.n(n),c=l(630294),d=l(345366),p=l(274363),m=l(350126),h=l(419637),y=l(45697),u=l.n(y),b=l(804504),v=l(756435),g=l(908316);function f(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}class w extends i().Component{render(){return i().createElement(g.Z,{containerId:"details-container",containerClassName:"dock-container",containerStyle:this.props.dockStyle,open:this.props.active,size:this.props.width,position:"right",bsStyle:"primary",title:i().createElement(b.Z,{msgId:"details.title"}),onClose:()=>this.props.onClose(),glyph:"sheet",style:this.props.dockStyle},i().createElement(c.Panel,{id:this.props.id,style:this.props.panelStyle,className:this.props.panelClassName},i().createElement(v.Z,null,this.props.children)))}}f(w,"propTypes",{id:u().string,active:u().bool,panelStyle:u().object,dockStyle:u().object,panelClassName:u().string,style:u().object,onClose:u().func,width:u().number}),f(w,"contextTypes",{messages:u().object}),f(w,"defaultProps",{id:"mapstore-details",panelStyle:{zIndex:100,marginBottom:0,minHeight:"100%"},style:{},onClose:()=>{},active:!1,panelClassName:"details-panel",width:550});const S=w;var C=l(283604),E=l(152543);var x=l(49977),T=l.n(x),k=l(313311),N=l.n(k),M=l(926854),O=l(687753),Z=l(288287),J=l(726598),D=l(835516),I=l(425589);const G=(e,t)=>e.ofType(d.eR).switchMap((()=>{const e=t.getState(),l=(0,p.Gi)(e),s=(0,D.getIdFromUri)(l);return T().Observable.fromPromise(Z.Z.getData(s).then((e=>e))).switchMap((e=>T().Observable.of((0,d.bR)(e)))).startWith((0,O.Xi)("details","enabled")).catch((()=>T().Observable.of((0,I.d)({message:"maps.feedback.errorFetchingDetailsOfMap"}),(0,d.bR)(d.hi))))})),P=e=>e.ofType(d.f8).switchMap((()=>T().Observable.from([(0,O.Xg)("details","enabled",!1)]))),U=(e,t)=>e.ofType(M.KS).switchMap((()=>{var e,l;const s=(0,p.J9)(t.getState()),a=null===(e=t.getState())||void 0===e||null===(l=e.tutorial)||void 0===l?void 0:l.run;return s?T().Observable.fromPromise(Z.Z.getResourceAttributes(s)).switchMap((e=>{let t=N()(e,{name:"details"});const l=N()(e,{name:"detailsSettings"});let i={};if(!t||t.value===J.Sp)return T().Observable.empty();try{i=JSON.parse(l.value)}catch(e){i={}}return T().Observable.of((0,d.XT)(s,t.value,i),...i.showAtStartup&&!a?[(0,d.UJ)()]:[])})):T().Observable.empty()}));var j=l(22222);const A=(0,E.rx)("Details",{component:(0,o.connect)((0,j.zB)({active:e=>r()(e,"controls.details.enabled"),dockStyle:e=>(0,m.ic)(e,{height:!0,right:!0},!0),detailsText:e=>{var t;return null==e||null===(t=e.details)||void 0===t?void 0:t.detailsText},showAsModal:e=>{var t;return null===(t=(0,p.qH)(e))||void 0===t?void 0:t.showAsModal}}),{onClose:d.nf})((e=>{let{active:t=!1,dockStyle:l,detailsText:s,showAsModal:a=!1,onClose:o=(()=>{})}=e;const n=i().createElement(h.Z,{className:"ms-details-preview-container",textContainerClassName:"ms-details-preview",loading:!s,detailsText:s===d.hi?null:s});return a?i().createElement(C.Z,{bodyClassName:"details-viewer-modal",fitContent:!0,showFullscreen:!0,show:t,size:"lg",title:i().createElement(b.Z,{msgId:"details.title"}),onClose:o},n):i().createElement(S,{width:550,dockStyle:l,active:t,onClose:o},n)})),containers:{BurgerMenu:{name:"details",position:1e3,priority:2,doNotHide:!0,text:i().createElement(b.Z,{msgId:"details.title"}),tooltip:"details.tooltip",icon:i().createElement(c.Glyphicon,{glyph:"sheet"}),action:d.UJ,selector:e=>{const t=(0,p.J9)(e);return t&&(0,p.Gi)(e,t)?{}:{style:{display:"none"}}}},Toolbar:{name:"details",position:2,priority:0,tooltip:"details.title",alwaysVisible:!0,doNotHide:!0,icon:i().createElement(c.Glyphicon,{glyph:"sheet"}),action:d.UJ,selector:e=>{const t=(0,p.J9)(e);return t&&(0,p.Gi)(e,t)?{}:{style:{display:"none"}}}},SidebarMenu:{name:"details",position:4,text:i().createElement(b.Z,{msgId:"details.title"}),tooltip:"details.tooltip",alwaysVisible:!0,icon:i().createElement(c.Glyphicon,{glyph:"sheet"}),action:d.UJ,selector:e=>{const t=(0,p.J9)(e);return t&&(0,p.Gi)(e,t)?{bsStyle:e.controls.details&&e.controls.details.enabled?"primary":"tray",active:e.controls.details&&e.controls.details.enabled||!1}:{style:{display:"none"}}},doNotHide:!0,priority:1}},epics:s,reducers:{details:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===d.UD?{...e,detailsText:t.detailsText}:e}}})}}]);